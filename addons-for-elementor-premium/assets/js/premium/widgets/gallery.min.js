(function($){function LAE_Gallery(){LAE_Block.apply(this,arguments)}LAE_Gallery.prototype=Object.create(LAE_Grid.prototype);LAE_Gallery.prototype.constructor=LAE_Gallery;LAE_Gallery.prototype._getFilteredItems=function(){var self=this;var filteredItems=[];if(self.filterTerm.length){filteredItems=self.items.filter(function(item){if(item["item_tags"].length){var terms=item["item_tags"].split(",");terms=terms.map(function(str){return str.trim().replace(/\s+/g,"-")});return terms.indexOf(self.filterTerm)!==-1}return false})}else{filteredItems=self.items}return filteredItems};LAE_Gallery.prototype._getMaxPages=function(){var self=this;var filteredItems=self._getFilteredItems();var itemsPerPage=self.settings["items_per_page"];return Math.ceil(filteredItems.length/itemsPerPage)};LAE_Gallery.prototype._getRemainingItems=function(){var self=this;var filteredItems=self._getFilteredItems();var itemsPerPage=self.settings["items_per_page"];var remainingItems=filteredItems.length-self.currentPage*itemsPerPage;return Math.max(0,remainingItems)};LAE_Gallery.prototype._getItemsToDisplay=function(){var self=this;var displayItems=self._getFilteredItems();var itemsPerPage=self.settings["items_per_page"];var start=itemsPerPage*(self.currentPage-1);var end=start+itemsPerPage;displayItems=displayItems.slice(start,end);return displayItems};LAE_Gallery.prototype._doAjaxBlockProcessResponse=function(cacheHit,response,userAction){var self=this;var responseObj=$.parseJSON(response);if(this.blockId!==responseObj.blockId)return;var $blockElem=$("#"+this.blockId);if("load_more"===userAction){var $blockElementInner=$blockElem.find(".lae-block-inner");var $response=$("<div></div>").html(responseObj.data);$response.imagesLoaded(function(){if(cacheHit==false)$blockElem.removeClass("lae-fetching");var $new_items=$response.children(".lae-block-column");if($new_items.length)$blockElementInner.isotope("insert",$new_items)})}else{var $blockElementInner=$blockElem.find(".lae-block-inner");var $existing_items=$blockElementInner.children(".lae-block-column");var $response=$("<div></div>").html(responseObj.data);$response.imagesLoaded(function(){if(cacheHit==false)$blockElem.removeClass("lae-fetching");$blockElementInner.isotope("remove",$existing_items);var $new_items=$response.children(".lae-block-column");if($new_items.length)$blockElementInner.isotope("insert",$new_items)})}var maxPages=self._getMaxPages();$blockElem.attr("data-current",self.currentPage);$blockElem.attr("data-maxpages",maxPages);$blockElem.find(".lae-pagination .lae-page-nav.lae-current-page").removeClass("lae-current-page");$blockElem.find('.lae-page-nav[data-page="'+parseInt(self.currentPage)+'"]').addClass("lae-current-page");$blockElem.find('.lae-page-nav[data-page="next"]').removeClass("lae-disabled");$blockElem.find('.lae-page-nav[data-page="prev"]').removeClass("lae-disabled");if(self.currentPage===1){$blockElem.find('.lae-page-nav[data-page="prev"]').addClass("lae-disabled")}if(self.currentPage>=maxPages){$blockElem.find('.lae-page-nav[data-page="next"]').addClass("lae-disabled")}if(responseObj.filterTerm.length){if(maxPages==1){$blockElem.find(".lae-page-nav").hide()}else{$blockElem.find(".lae-page-nav").each(function(){var page=$(this).attr("data-page");if(page.match("prev|next")){$(this).show()}else if(parseInt(page)>maxPages){$(this).hide()}else{$(this).show()}})}}else{$blockElem.find(".lae-page-nav").show()}this._processNumberedPagination();var remainingPosts=parseInt(self._getRemainingItems());if(self.settings["show_remaining"]&&remainingPosts!==0){$blockElem.find(".lae-pagination a.lae-load-more span").text(remainingPosts)}if(remainingPosts===0){$blockElem.find(".lae-pagination a.lae-load-more").addClass("lae-disabled")}else{$blockElem.find(".lae-pagination a.lae-load-more").removeClass("lae-disabled")}};LAE_Gallery.prototype.initLightbox=function($blockElem){if($().fancybox===undefined){return}var lightboxSelector=".lae-block"+"."+this.settings["block_class"]+" "+"a.lae-lightbox-item:not(.elementor-clickable)";lightboxSelector+=","+".lae-block"+"."+this.settings["block_class"]+" "+"a.lae-video-lightbox:not(.elementor-clickable)";$blockElem.fancybox({selector:lightboxSelector,loop:true,buttons:["zoom","share","slideShow","fullScreen","thumbs","close"],thumbs:{autoStart:false,hideOnClose:true,axis:"x"},caption:function(instance,item){var caption=$(this).attr("title")||"";var description=$(this).data("description")||"";if(description!==""){caption+='<div class="lae-fancybox-description">'+description+"</div>"}return caption}})};var laeGalleries=Object.create(laeBlocks);laeGalleries.getBlockObjById=function(blockId){var blockIndex=this._getBlockIndex(blockId);if(blockIndex!==-1)return laeBlockObjColl[blockIndex];var blockObj=new LAE_Gallery(blockId);laeBlockObjColl.push(blockObj);return blockObj};var WidgetLAEGalleryHandler=function($scope,$){var $blockElem=$scope.find(".lae-block");var rtl=$blockElem.attr("dir")==="rtl";if($blockElem.find(".lae-module").length===0){return}var currentBlockObj=laeGalleries.getBlockObjById($blockElem.data("block-uid"));var layoutMode=currentBlockObj.settings["layout_mode"];var $blockElemInner=$blockElem.find(".lae-block-inner");$blockElemInner.isotope({itemSelector:".lae-block-column",layoutMode:layoutMode,originLeft:!rtl,transitionDuration:"0.8s",masonry:{columnWidth:".lae-grid-sizer"}});$blockElemInner.imagesLoaded(function(){$blockElemInner.isotope("layout")});$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange",function(e){$blockElemInner.isotope("layout")});var laeResizeTimeout;$(window).resize(function(){if(!!laeResizeTimeout){clearTimeout(laeResizeTimeout)}laeResizeTimeout=setTimeout(function(){currentBlockObj.organizeFilters()},200)});$scope.find(".lae-taxonomy-filter .lae-filter-item a, .lae-block-filter .lae-block-filter-item a").on("click",function(e){e.preventDefault();currentBlockObj.handleFilterAction($(this));return false});var pagination=currentBlockObj.settings["pagination"];$scope.find(".lae-pagination a.lae-page-nav").on("click",function(e){e.preventDefault();currentBlockObj.handlePageNavigation($(this))});$scope.find(".lae-pagination a.lae-load-more").on("click",function(e){e.preventDefault();currentBlockObj.handleLoadMore($(this))});if(pagination=="infinite_scroll"){var helper=new LAE_Grid_Helper($scope);helper.setupInfiniteScroll()}currentBlockObj.initLightbox($blockElem)};$(window).on("elementor/frontend/init",function(){elementorFrontend.hooks.addAction("frontend/element_ready/lae-gallery.default",WidgetLAEGalleryHandler)})})(jQuery);